html,
body {
    overscroll-behavior: none;
}

body {
    margin: 0;
    padding: 0;

    box-sizing: border-box;
    font-family: var(--ui-font-body);

    font-synthesis: none;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    color: white;
}

/* 
    screen-outer is used as a background layer, that 
    encompasses the full (dynamic) device width and height
    of the webview. This is then used to position the
    screen inner, which serves as content space.
*/
.screen-outer {
    display: flex;
    flex-direction: column;

    height: 100dvh;
    width: 100dvw;

    & .screen-inner {
        background: rgba(0, 0, 0, 0.25);
        display: flex;
        flex-direction: column;

        flex-grow: 1;
        padding-bottom: env(safe-area-inset-bottom, 0);
        border-bottom-left-radius: env(safe-area-inset-left, 0);
        border-bottom-right-radius: env(safe-area-inset-right, 0);
    }
}

.background {
    position: fixed;
    display: flex;
    flex-direction: column;
    justify-content: center;
    inset: 0;
    filter: saturate(0.7);

    & img {
        object-fit: cover;
        height: 100%;
    }
}

.content {
    z-index: 1;
}

/* A content Divider is used to visually separate content */
.content-divider {
    width: 100%;
    height: 0.125rem;
    background: white;
}

/* Game Ui Overlay */
.overlay {
    position: fixed;
    inset: 0;
    z-index: 10000000000;
    pointer-events: none;
    padding: 0.5rem;
}

/* Screen navigation */
.screen-navigation {
    position: fixed;
    bottom: 0;
    right: 0;
    margin: 1rem;

    & ul {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        padding: 0;
        margin: 0;

        & li {
            display: flex;
            list-style-type: none;
        }
    }

    & button {
        pointer-events: all;
        background: none;
        width: 48px;
        height: 48px;
        padding: 0;
        border: none;
        transition: transform 0.1s ease;
        touch-action: manipulation;

        &:active {
            transform: scale(0.9);
        }

        & img {
            display: block;
            width: 100%;
            height: 100%;
        }
    }
}

/* Avatar group */

.avatar-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    justify-content: center;
    align-items: flex-start;
    width: 0;

    & .player-avatar {
        width: clamp(1.5rem, 10vw, 2.5rem);
        height: clamp(1.5rem, 10vw, 2.5rem);
        background: var(--color-avatar-bg);
        border: 2px solid var(--color-avatar-bg);
        border-radius: 100%;
        transition: 0.25s ease-in-out;
        border: 2px solid #3a2f26;

        &[data-is-active="true"] {
            width: clamp(2.5rem, 15vw, 3.5rem);
            height: clamp(2.5rem, 15vw, 3.5rem);
            border-color: white;
            box-shadow: 0px 0px 2px 4px rgba(120, 42, 0, 0.5);
        }

        & img {
            width: 100%;
            height: 100%;
            aspect-ratio: 1 / 1;
        }
    }
}

/* Context Menu */
.context-shell {
    display: flex;
    justify-content: center;
    align-items: center;
    animation: fade-in 200ms;
    gap: 0.2rem;
    width: 0;
    height: 0;

    & .context-action {
        background: none;
        border: none;
        padding: 0;
        display: flex;
        translate: 0 -32px;

        &[disabled] {
            pointer-events: none;
            filter: brightness(0.5);
        }
    }
}

/* Tile Overview */
.tile-panel {
    position: fixed;
    bottom: 0;
    inset-inline: 0;
    margin: 0.5rem;
    padding: 1.25rem 1.5rem;
    border-radius: 1.5rem;

    background-color: #181511ee; /* dark semi-transparent parchment tone */
    background-image: url("./textures/background.png");
    background-size: cover;
    background-position: center;

    color: #f0e6dc;
    font: var(--ui-font-body);
    text-shadow: 0 0 1px #000;

    box-shadow: inset 0 4px 10px rgba(0, 0, 0, 0.5), inset 0 -2px 6px rgba(255, 255, 255, 0.05), 0 6px 14px
        rgba(0, 0, 0, 0.6);
    border: 5px solid #3a2f26;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    color: #f6ead8;

    z-index: 100;

    & > .row {
        align-items: start;
    }

    & .tile-title {
        font-family: var(--ui-font-heading);
        font-size: 7vw;
        text-shadow: 0px 0px 2px #f6ead8, 0px 0px 3px black;
    }

    & .tile-coordinates {
        font-family: var(--ui-font-heading);
        font-size: 5vw;
        opacity: 0.7;
    }

    & .tile-claimant {
        font-size: 5.2vw;
        opacity: 0.9;
    }

    & .tile-description {
        font-size: 5.2vw;
    }
}

/* Mission Overlay */
.mission-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.9);
    border-radius: 1.5rem;
    margin: 0.5rem;
    padding: 1.75rem 0.75rem;
    display: flex;
    flex-direction: column;
    gap: 1.0rem;
    pointer-events: all;
    background-image: url("./textures/background.png");
    background-size: cover;
    background-position: center;
    font: var(--ui-font-body);
    z-index: 100;

    /* Thicker, deeper 3D inset look */
    border: 6px solid #3b2f26;
    box-shadow: inset 0 6px 12px rgba(0, 0, 0, 0.45), inset 0 -4px 8px rgba(255, 255, 255, 0.06), 0 4px 10px
        rgba(0, 0, 0, 0.6);
    text-shadow: 0px 0px 1px black;
    animation: scale-in 400ms forwards;

    & em {
        color: indianred;
    }

    & .title {
        font-size: 8vw;
        text-align: center;
    }

    & .instruction {
        text-align: center;
        font-size: 6vw;
    }

    & .mission-cards {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    & .mission-card {
        background-color: #1e1a16;
        border: 4px solid #3a3228;
        border-radius: 1rem;
        padding: 1rem 1.25rem;
        font: var(--ui-font-body);
        color: #e2dacd;
        text-align: left;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6), /* ambient drop shadow */ 0 0 8px rgba(242, 231, 213, 0.08), /* soft glow */
            0 0 16px rgba(242, 231, 213, 0.05); /* outer ethereal aura */
        transition: transform 0.1s ease;
        touch-action: manipulation;

        &:active {
            transform: scale(0.97);
            background-color: #191612;
        }

        &[data-mission-type="solo"] {
            border-color: #5e4633;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6), 0 0 8px rgba(94, 70, 51, 0.15), 0 0 16px rgba(94, 70, 51, 0.08);
        }

        &[data-mission-type="diplomatic"] {
            border-color: #42334e;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6), 0 0 8px rgba(66, 51, 78, 0.15), 0 0 16px rgba(66, 51, 78, 0.08);
        }

        & .title {
            font-weight: 700;
            font-size: 7vw;
            color: white;
            text-shadow: 0 1px 0 #000;
        }

        & .description {
            font-size: 4.4vw;
            line-height: 1.4;
            color: #b8aea1;
            opacity: 0.95;
            text-shadow: 0 1px 0 #000;
        }
    }
}

/* Animations */

@keyframes fade-in {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes scale-in {
    from {
        opacity: 0;
        scale: 0.25;
    }
    to {
        opacity: 1;
        scale: 1;
    }
}
